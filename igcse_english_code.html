<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IGCSE English 0500 Learning App</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;color:#333}.container{max-width:1000px;margin:0 auto;background:#fff;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden}.header{background:linear-gradient(135deg,#5a67d8 0%,#6b46c1 100%);color:#fff;padding:30px;text-align:center}.header h1{font-size:24px;margin-bottom:10px}.progress-bar-container{background:rgba(255,255,255,0.2);height:8px;border-radius:4px;margin-top:15px}.progress-bar{background:#48bb78;height:100%;border-radius:4px;transition:width 0.3s}.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px;padding:20px;background:#f7fafc;border-bottom:2px solid #e2e8f0}.stat-card{background:#fff;padding:15px;border-radius:10px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,0.1)}.stat-card .label{font-size:11px;color:#718096;text-transform:uppercase}.stat-card .value{font-size:22px;font-weight:bold;color:#5a67d8}.nav-tabs{display:flex;background:#edf2f7;padding:0 20px;border-bottom:2px solid #cbd5e0;overflow-x:auto}.nav-tab{padding:12px 20px;background:none;border:none;cursor:pointer;font-size:14px;color:#4a5568;border-bottom:3px solid transparent}.nav-tab:hover{color:#5a67d8;background:rgba(90,103,216,0.1)}.nav-tab.active{color:#5a67d8;font-weight:bold;border-bottom-color:#5a67d8;background:#fff}.content{padding:30px}.section{display:none}.section.active{display:block;animation:fadeIn 0.3s}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.topic-list{display:grid;gap:15px}.topic-card{background:#fff;border:2px solid #e2e8f0;border-radius:12px;padding:20px;cursor:pointer;transition:all 0.3s}.topic-card:hover{border-color:#5a67d8;transform:translateY(-2px)}.topic-card.completed{border-color:#48bb78;background:linear-gradient(to right,#f0fff4 0%,#fff 20%)}.topic-card.in-progress{border-color:#ed8936;background:linear-gradient(to right,#fffaf0 0%,#fff 20%)}.topic-header{display:flex;justify-content:space-between;margin-bottom:10px}.topic-title{font-size:16px;font-weight:bold;color:#2d3748}.topic-badge{padding:4px 10px;border-radius:12px;font-size:10px;font-weight:bold;text-transform:uppercase}.badge-mastered{background:#c6f6d5;color:#22543d}.badge-progress{background:#feebc8;color:#7c2d12}.badge-new{background:#e6fffa;color:#234e52}.topic-description{color:#718096;font-size:13px;margin-bottom:10px}.topic-progress{font-size:12px;color:#4a5568;font-weight:600}.question-container{background:#f7fafc;border-radius:12px;padding:25px;margin-bottom:20px}.question-text{font-size:16px;color:#2d3748;margin-bottom:20px;line-height:1.6;white-space:pre-wrap}.question-number{display:inline-block;background:#5a67d8;color:#fff;padding:4px 12px;border-radius:6px;font-size:12px;font-weight:bold;margin-bottom:10px}.answer-input{width:100%;padding:12px;border:2px solid #cbd5e0;border-radius:8px;font-size:15px;font-family:inherit;margin-bottom:15px}textarea.answer-input{min-height:150px;resize:vertical}.answer-input:focus{outline:none;border-color:#5a67d8}.button-group{display:flex;gap:10px;flex-wrap:wrap}.btn{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.3s;text-transform:uppercase}.btn-primary{background:#5a67d8;color:#fff}.btn-primary:hover{background:#4c51bf}.btn-primary:disabled{background:#a0aec0;cursor:not-allowed}.btn-secondary{background:#718096;color:#fff}.btn-secondary:hover{background:#4a5568}.btn-success{background:#48bb78;color:#fff}.btn-success:hover{background:#38a169}.btn-danger{background:#f56565;color:#fff}.btn-danger:hover{background:#e53e3e}.feedback{margin-top:20px;padding:20px;border-radius:12px}.feedback.correct{background:#c6f6d5;border-left:4px solid #38a169;color:#22543d}.feedback.incorrect{background:#fed7d7;border-left:4px solid #e53e3e;color:#742a2a}.feedback-title{font-weight:bold;font-size:16px;margin-bottom:10px}.feedback-content{line-height:1.6}.assessment-grid{display:grid;gap:12px;margin-top:15px}.assessment-item{background:#fff;padding:12px;border-radius:8px;border-left:4px solid #cbd5e0}.assessment-item.good{border-left-color:#48bb78}.assessment-item.needs-improvement{border-left-color:#ed8936}.assessment-label{font-weight:bold;font-size:13px;color:#2d3748}.assessment-score{font-size:20px;font-weight:bold;color:#5a67d8;margin-right:8px}.badges-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:12px;margin-top:20px}.badge-item{background:#fff;border:2px solid #e2e8f0;border-radius:12px;padding:12px;text-align:center}.badge-item.earned{border-color:#48bb78;background:linear-gradient(135deg,#f0fff4 0%,#fff 100%)}.badge-item.locked{opacity:0.5;filter:grayscale(100%)}.badge-icon{font-size:35px;margin-bottom:5px}.badge-name{font-size:11px;font-weight:bold;color:#2d3748}.help-section{line-height:1.8}.help-section h2{color:#5a67d8;margin:20px 0 10px;font-size:20px}.help-section h3{color:#4a5568;margin:15px 0 8px;font-size:16px}.help-section ul{margin-left:20px;margin-bottom:12px}.help-section li{margin-bottom:6px;color:#4a5568}.mastery-check{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:30px;border-radius:12px;text-align:center;margin-top:30px}.mastery-check h3{font-size:22px;margin-bottom:15px}.mastery-score{font-size:44px;font-weight:bold;margin:20px 0}.mastery-message{font-size:16px;margin-bottom:20px}@media(max-width:768px){.stats{grid-template-columns:repeat(2,1fr)}.content{padding:20px}.btn{width:100%}}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>Cambridge IGCSE First Language English 0500</h1>
<p>Master your reading and writing skills</p>
<div class="progress-bar-container"><div class="progress-bar" id="overallProgress"></div></div>
</div>
<div class="stats">
<div class="stat-card"><div class="label">Level</div><div class="value" id="levelDisplay">1</div></div>
<div class="stat-card"><div class="label">XP</div><div class="value" id="xpDisplay">0</div></div>
<div class="stat-card"><div class="label">Badges</div><div class="value" id="badgesDisplay">0</div></div>
<div class="stat-card"><div class="label">Mastery</div><div class="value" id="masteryDisplay">0%</div></div>
</div>
<div class="nav-tabs">
<button class="nav-tab active" onclick="switchTab('home')">Home</button>
<button class="nav-tab" onclick="switchTab('paper1')">Paper 1</button>
<button class="nav-tab" onclick="switchTab('paper2')">Paper 2</button>
<button class="nav-tab" onclick="switchTab('badges')">Badges</button>
<button class="nav-tab" onclick="switchTab('progress')">Progress</button>
<button class="nav-tab" onclick="switchTab('help')">Help</button>
</div>
<div class="content">
<div id="homeSection" class="section active">
<h2 style="margin-bottom:20px;color:#2d3748">Welcome to Your Learning Journey</h2>
<p style="margin-bottom:20px;color:#4a5568;line-height:1.6">This app will help you master the skills needed for Cambridge IGCSE First Language English. Choose a paper below to begin practicing.</p>
<div class="topic-list">
<div class="topic-card" onclick="switchTab('paper1')"><div class="topic-header"><div class="topic-title">Paper 1: Reading</div><div class="topic-badge badge-new" id="paper1Badge">Start</div></div><div class="topic-description">Reading comprehension and summary writing</div><div class="topic-progress" id="paper1Progress">0% Complete</div></div>
<div class="topic-card" onclick="switchTab('paper2')"><div class="topic-header"><div class="topic-title">Paper 2: Writing</div><div class="topic-badge badge-new" id="paper2Badge">Start</div></div><div class="topic-description">Directed writing and composition</div><div class="topic-progress" id="paper2Progress">0% Complete</div></div>
</div>
</div>
<div id="paper1Section" class="section"><div id="paper1Topics"></div></div>
<div id="paper2Section" class="section"><div id="paper2Topics"></div></div>
<div id="practiceSection" class="section"><button class="btn btn-secondary" style="margin-bottom:20px" onclick="returnToTopics()">Back to Topics</button><div id="practiceContent"></div></div>
<div id="badgesSection" class="section"><h2 style="margin-bottom:20px;color:#2d3748">Your Badges</h2><div class="badges-container" id="badgesContainer"></div></div>
<div id="progressSection" class="section"><h2 style="margin-bottom:20px;color:#2d3748">Your Progress Report</h2><div style="margin-bottom:20px"><button class="btn btn-success" onclick="generateReport()">Download Report</button> <button class="btn btn-secondary" onclick="exportProgress()">Export Progress</button> <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">Import Progress</button><input type="file" id="importFile" style="display:none" accept=".json" onchange="importProgress(event)"> <button class="btn btn-danger" onclick="resetProgress()">Reset Progress</button></div><div id="progressDetails"></div></div>
<div id="helpSection" class="section"><div class="help-section"><h2>How to Use This App</h2><h3>Getting Started</h3><ul><li>Navigate using tabs at the top</li><li>Click topics to start practicing</li><li>Complete questions to earn XP and badges</li></ul><h3>Mastery System</h3><ul><li>Achieve 80% mastery in each topic to complete it</li><li>Get feedback and retry incorrect answers</li><li>Track progress on the Home screen</li></ul><h3>Saving Progress</h3><ul><li>Progress saves automatically in your browser</li><li>Export/Import to backup or transfer between devices</li><li>Download reports to share with teachers</li></ul></div></div>
</div>
</div>
<script>
const userData={xp:0,level:1,badges:[],topicProgress:{},questionAttempts:{}};
const badges=[
{id:'first_steps',name:'First Steps',icon:'ðŸŽ¯',req:'Complete first question'},
{id:'paper1_master',name:'Paper 1 Master',icon:'ðŸ“–',req:'Master all Paper 1 topics'},
{id:'paper2_master',name:'Paper 2 Master',icon:'âœï¸',req:'Master all Paper 2 topics'},
{id:'level_5',name:'Level 5',icon:'â­',req:'Reach Level 5'},
{id:'perfectionist',name:'Perfectionist',icon:'ðŸ’¯',req:'Score 100% on any topic'},
{id:'scholar',name:'Scholar',icon:'ðŸŽ“',req:'Reach 80% overall mastery'}
];
const topics={
paper1:[
{id:'comprehension',title:'Reading Comprehension',description:'Understanding explicit and implicit meanings',questions:[
{type:'short',text:'Read this passage:\n\n"The ancient library stood silent, its towering shelves groaning under centuries of accumulated knowledge. Dust motes danced in the thin shafts of light that pierced the gloom."\n\nWhat does the word "groaning" suggest about the shelves?',answer:'The shelves are struggling under heavy weight, possibly overloaded',hints:['Think about what groaning sounds like','Consider the weight of the books'],explanation:'The word "groaning" is personification - it suggests the shelves are under strain from the weight of many books.'},
{type:'short',text:'Read this passage:\n\n"Maria hesitated at the doorway, her fingers tightening around the envelope. She had rehearsed this moment a hundred times, yet now her voice seemed to have abandoned her."\n\nWhat does this suggest about Maria\'s feelings?',answer:'Maria is nervous, anxious, or afraid',hints:['Look at her physical actions','Think about why she might hesitate'],explanation:'The passage shows Maria\'s anxiety: she hesitates, grips the envelope tightly, and loses her voice - all signs of nervousness.'}
]},
{id:'summary',title:'Summary Writing',description:'Selecting and organizing information concisely',questions:[
{type:'long',text:'Read this passage about sustainable farming:\n\n"Modern sustainable farming employs various techniques to protect the environment. Crop rotation prevents soil depletion by alternating different plants each season. Farmers use natural pest control methods, introducing beneficial insects rather than chemical pesticides. Water conservation systems collect rainwater for irrigation, reducing dependence on groundwater. Organic fertilizers enrich the soil without harmful chemicals. Many farms now integrate solar panels to generate clean energy for operations."\n\nWrite a summary of the sustainable farming techniques mentioned. Use your own words. (Maximum 60 words)',answer:'',wordLimit:60,assessmentCriteria:{relevance:'crop rotation, natural pest control, water conservation, organic fertilizers, solar energy',ownWords:'Uses different vocabulary',conciseness:'Within 60 words',organization:'Logical flow'},hints:['Identify key techniques','Rephrase in your own words','Keep under 60 words'],explanation:'A good summary identifies all five techniques and expresses them concisely in your own words without copying phrases.'}
]}
],
paper2:[
{id:'directed_writing',title:'Directed Writing',description:'Writing to argue, persuade or discuss',questions:[
{type:'long',text:'Read this information:\n\nYour school is considering banning mobile phones on campus entirely. Supporters argue phones distract from learning and reduce face-to-face interaction. Critics claim phones are essential for safety, research, and communication.\n\nWrite a letter to your headteacher presenting your views. You should:\nâ€¢ Evaluate arguments for and against\nâ€¢ Present your position with reasoning\nâ€¢ Suggest alternative solutions\n\nWrite 250-350 words.',answer:'',wordLimit:350,assessmentCriteria:{content:'Addresses all bullet points',register:'Formal letter format',structure:'Clear organization',persuasion:'Effective techniques',vocabulary:'Sophisticated choices',accuracy:'Minimal errors'},hints:['Use proper letter format','Balance both viewpoints','Use formal language'],explanation:'Your letter should use formal conventions, evaluate both perspectives, present a clear position, and suggest alternatives.'}
]},
{id:'descriptive_writing',title:'Descriptive Writing',description:'Creating vivid descriptions with sensory details',questions:[
{type:'long',text:'Write a description suggested by this title:\n\n"The Abandoned Fairground"\n\nCreate a vivid picture using sensory details and varied language. Focus on atmosphere and mood.\n\nWrite 350-450 words.',answer:'',wordLimit:450,assessmentCriteria:{imagery:'Strong sensory images',vocabulary:'Sophisticated choices',structure:'Effective organization',techniques:'Literary devices',engagement:'Maintains interest',accuracy:'Excellent control'},hints:['Use all five senses','Vary your focus','Create eerie mood'],explanation:'Your description should paint a vivid picture using rich sensory details, varied focus, and figurative language to create atmosphere.'}
]}
]
};
let currentTopic=null,currentQuestionIndex=0,hintIndex=0;
function init(){loadProgress();updateStats();renderPaper1Topics();renderPaper2Topics();renderBadges();updateHomeScreen()}
function loadProgress(){const s=localStorage.getItem('igcseProgress');if(s)Object.assign(userData,JSON.parse(s))}
function saveProgress(){localStorage.setItem('igcseProgress',JSON.stringify(userData))}
function updateStats(){document.getElementById('levelDisplay').textContent=userData.level;document.getElementById('xpDisplay').textContent=userData.xp;document.getElementById('badgesDisplay').textContent=userData.badges.length;const m=calculateOverallMastery();document.getElementById('masteryDisplay').textContent=m+'%';document.getElementById('overallProgress').style.width=m+'%';saveProgress()}
function calculateOverallMastery(){let t=0,m=0;['paper1','paper2'].forEach(p=>{topics[p].forEach(tp=>{t++;const pr=userData.topicProgress[tp.id];if(pr&&pr.mastery>=80)m++})});return t>0?Math.round((m/t)*100):0}
function switchTab(tab){document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));event.target.classList.add('active');document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));const sm={'home':'homeSection','paper1':'paper1Section','paper2':'paper2Section','badges':'badgesSection','progress':'progressSection','help':'helpSection'};document.getElementById(sm[tab]).classList.add('active');if(tab==='progress')renderProgressDetails()}
function renderPaper1Topics(){const c=document.getElementById('paper1Topics');c.innerHTML='<h2 style="margin-bottom:20px;color:#2d3748">Paper 1: Reading</h2>';const tl=document.createElement('div');tl.className='topic-list';topics.paper1.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};tl.appendChild(createTopicCard(t,p))});c.appendChild(tl)}
function renderPaper2Topics(){const c=document.getElementById('paper2Topics');c.innerHTML='<h2 style="margin-bottom:20px;color:#2d3748">Paper 2: Writing</h2>';const tl=document.createElement('div');tl.className='topic-list';topics.paper2.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};tl.appendChild(createTopicCard(t,p))});c.appendChild(tl)}
function createTopicCard(t,p){const c=document.createElement('div');c.className='topic-card';if(p.mastery>=80)c.classList.add('completed');else if(p.completed>0)c.classList.add('in-progress');const b=p.mastery>=80?'badge-mastered':p.completed>0?'badge-progress':'badge-new';const bt=p.mastery>=80?'Mastered':p.completed>0?'In Progress':'New';c.innerHTML=`<div class="topic-header"><div class="topic-title">${t.title}</div><div class="topic-badge ${b}">${bt}</div></div><div class="topic-description">${t.description}</div><div class="topic-progress">${p.mastery}% Mastery (${p.completed}/${p.total} questions)</div>`;c.onclick=()=>startTopic(t);return c}
function startTopic(t){currentTopic=t;currentQuestionIndex=0;document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));document.getElementById('practiceSection').classList.add('active');showQuestion()}
function returnToTopics(){currentTopic=null;currentQuestionIndex=0;document.getElementById('practiceSection').classList.remove('active');document.getElementById('homeSection').classList.add('active');renderPaper1Topics();renderPaper2Topics();updateHomeScreen()}
function showQuestion(){if(!currentTopic)return;const q=currentTopic.questions[currentQuestionIndex];const c=document.getElementById('practiceContent');c.innerHTML=`<h2 style="margin-bottom:20px;color:#2d3748">${currentTopic.title}</h2><div class="question-container"><div class="question-number">Question ${currentQuestionIndex+1} of ${currentTopic.questions.length}</div><div class="question-text">${q.text}</div>${q.type==='short'?'<input type="text" class="answer-input" id="answerInput" placeholder="Type your answer...">':'<textarea class="answer-input" id="answerInput" placeholder="Type your answer..." rows="10"></textarea>'}${q.wordLimit?`<div style="color:#718096;font-size:13px;margin-top:5px">Word limit: ${q.wordLimit} | Current: <span id="wordCount">0</span> words</div>`:''}< class="button-group"><button class="btn btn-primary" onclick="submitAnswer()">Submit</button> <button class="btn btn-secondary" onclick="showHint()">Hint</button></div></div><div id="feedbackContainer"></div>`;if(q.wordLimit)document.getElementById('answerInput').addEventListener('input',()=>{const t=document.getElementById('answerInput').value.trim();const w=t.length>0?t.split(/\s+/).length:0;document.getElementById('wordCount').textContent=w})}
function showHint(){const q=currentTopic.questions[currentQuestionIndex];if(!q.hints||hintIndex>=q.hints.length){alert('No more hints!');return}const fc=document.getElementById('feedbackContainer');const hd=document.createElement('div');hd.className='feedback';hd.style.background='#e6fffa';hd.style.borderLeftColor='#319795';hd.style.color='#234e52';hd.innerHTML=`<div class="feedback-title">Hint ${hintIndex+1}:</div><div class="feedback-content">${q.hints[hintIndex]}</div>`;fc.appendChild(hd);hintIndex++}
function submitAnswer(){const a=document.getElementById('answerInput').value.trim();const q=currentTopic.questions[currentQuestionIndex];if(!a){alert('Please provide an answer.');return}const sb=event.target;sb.disabled=true;sb.textContent='Checking...';const f=q.type==='short'?assessShortAnswer(a,q):assessLongAnswer(a,q);displayFeedback(f);if(f.correct){awardXP(q.type==='short'?20:50);updateTopicProgress(true)}else{updateTopicProgress(false)}sb.disabled=false;sb.textContent='Submit'}
function assessShortAnswer(ua,q){const n=ua.toLowerCase().trim();const e=q.answer.toLowerCase().trim();const kw=e.split(/\s+/).filter(w=>w.length>3);const mw=kw.filter(w=>n.includes(w));const mp=(mw.length/kw.length)*100;const c=mp>=60;return{correct:c,score:Math.round(mp),feedback:c?'Excellent! Good understanding.':'Your answer needs improvement. '+q.explanation,suggestions:c?[]:['Consider: '+q.explanation]}}
function assessLongAnswer(ua,q){const wc=ua.split(/\s+/).length;const a={clarity:0,accuracy:0,grammar:0,spelling:0,overall:0,suggestions:[]};if(q.wordLimit){if(wc>q.wordLimit*1.1)a.suggestions.push(`Exceeds word limit (${wc}/${q.wordLimit}). Be more concise.`);else if(wc<q.wordLimit*0.7)a.suggestions.push(`Too short (${wc}/${q.wordLimit}). Develop more fully.`)}const se=checkSpelling(ua);const gi=checkGrammar(ua);a.spelling=Math.max(0,100-(se.length*10));a.grammar=Math.max(0,100-(gi.length*10));if(se.length>0)a.suggestions.push('Spelling: '+se.join(', '));if(gi.length>0)a.suggestions.push('Grammar: '+gi.join('; '));const cs=assessContent(ua,q);a.accuracy=cs.score;a.suggestions.push(...cs.suggestions);a.clarity=assessClarity(ua);a.overall=Math.round((a.clarity+a.accuracy+a.grammar+a.spelling)/4);return{correct:a.overall>=70,score:a.overall,assessment:a,feedback:a.overall>=80?'Excellent!':a.overall>=70?'Good effort!':a.overall>=60?'Satisfactory':'Needs improvement',suggestions:a.suggestions}}
function checkSpelling(t){const cm={'recieve':'receive','occured':'occurred','seperate':'separate','definately':'definitely','arguement':'argument','untill':'until','writting':'writing','begining':'beginning','beleive':'believe'};const e=[];const w=t.toLowerCase().match(/\b\w+\b/g)||[];w.forEach(wd=>{if(cm[wd])e.push(`"${wd}" â†’ "${cm[wd]}"`)});return[...new Set(e)]}
function checkGrammar(t){const i=[];if(/\bi\s/gi.test(t)&&!/\bI\s/.test(t))i.push('"I" should be capitalized');if(/\s{2,}/.test(t))i.push('Multiple spaces - use single spaces');if(/[a-z]\.[A-Z]/.test(t))i.push('Missing space after period');if(!/[.!?]$/.test(t.trim()))i.push('Missing end punctuation');return[...new Set(i)]}
function assessContent(ua,q){const r={score:50,suggestions:[]};if(q.assessmentCriteria&&q.assessmentCriteria.relevance){const la=ua.toLowerCase();const kp=q.assessmentCriteria.relevance.toLowerCase().split(/,|;|\band\b/);const ad=kp.filter(p=>p.split(/\s+/).some(w=>w.length>4&&la.includes(w)));const co=(ad.length/kp.length)*100;r.score=Math.round(co);if(co<70)r.suggestions.push(`Address all key points: ${q.assessmentCriteria.relevance}`)}return r}
function assessClarity(t){let s=100;const sn=t.split(/[.!?]+/).filter(x=>x.trim().length>0);const as=t.split(/\s+/).length/sn.length;if(as>30)s-=20;if(as<8)s-=10;return Math.max(0,s)}
function displayFeedback(f){const c=document.getElementById('feedbackContainer');const q=currentTopic.questions[currentQuestionIndex];const fd=document.createElement('div');fd.className=`feedback ${f.correct?'correct':'incorrect'}`;let h=`<div class="feedback-title">${f.correct?'Correct!':'Needs Improvement'}</div><div class="feedback-content">${f.feedback}</div>`;if(f.assessment){h+='<div class="assessment-grid">';h+=`<div class="assessment-item ${f.assessment.clarity>=70?'good':'needs-improvement'}"><div class="assessment-label">Clarity</div><span class="assessment-score">${f.assessment.clarity}/100</span></div>`;h+=`<div class="assessment-item ${f.assessment.accuracy>=70?'good':'needs-improvement'}"><div class="assessment-label">Accuracy</div><span class="assessment-score">${f.assessment.accuracy}/100</span></div>`;h+=`<div class="assessment-item ${f.assessment.grammar>=70?'good':'needs-improvement'}"><div class="assessment-label">Grammar</div><span class="assessment-score">${f.assessment.grammar}/100</span></div>`;h+=`<div class="assessment-item ${f.assessment.spelling>=70?'good':'needs-improvement'}"><div class="assessment-label">Spelling</div><span class="assessment-score">${f.assessment.spelling}/100</span></div>`;h+='</div>'}if(f.suggestions&&f.suggestions.length>0){h+='<div style="margin-top:15px"><strong>Suggestions:</strong><ul style="margin-left:20px;margin-top:8px">';f.suggestions.forEach(s=>h+=`<li style="margin-bottom:5px">${s}</li>`);h+='</ul></div>'}h+=`<div style="margin-top:15px"><strong>Explanation:</strong><br>${q.explanation}</div>`;h+='<div class="button-group" style="margin-top:20px">';if(f.correct){if(currentQuestionIndex<currentTopic.questions.length-1)h+='<button class="btn btn-success" onclick="nextQuestion()">Next</button>';else h+='<button class="btn btn-success" onclick="completeTopic()">Complete</button>'}else{h+='<button class="btn btn-primary" onclick="retryQuestion()">Try Again</button>';if(currentQuestionIndex<currentTopic.questions.length-1)h+='<button class="btn btn-secondary" onclick="nextQuestion()">Skip</button>'}h+='</div>';fd.innerHTML=h;c.innerHTML='';c.appendChild(fd);hintIndex=0}
function nextQuestion(){currentQuestionIndex++;showQuestion();hintIndex=0}
function retryQuestion(){document.getElementById('answerInput').value='';document.getElementById('feedbackContainer').innerHTML='';hintIndex=0}
function updateTopicProgress(c){if(!userData.topicProgress[currentTopic.id])userData.topicProgress[currentTopic.id]={completed:0,total:currentTopic.questions.length,correct:0,mastery:0};const p=userData.topicProgress[currentTopic.id];if(c){if(!userData.questionAttempts[currentTopic.id])userData.questionAttempts[currentTopic.id]={};if(!userData.questionAttempts[currentTopic.id][currentQuestionIndex]){p.completed++;p.correct++}userData.questionAttempts[currentTopic.id][currentQuestionIndex]=true}p.mastery=Math.round((p.correct/p.total)*100);checkBadges();saveProgress()}
function completeTopic(){const p=userData.topicProgress[currentTopic.id];if(p.mastery>=80){document.getElementById('practiceContent').innerHTML=`<div class="mastery-check"><h3>Topic Completed!</h3><div class="mastery-score">${p.mastery}%</div><div class="mastery-message">${p.mastery>=80?'Congratulations! You have mastered this topic!':'Keep practicing to reach 80% mastery!'}</div><button class="btn btn-success" onclick="returnToTopics()" style="background:#fff;color:#5a67d8">Return</button></div>`;checkBadges()}else{alert(`Your mastery is ${p.mastery}%. Need 80%. Keep practicing!`);currentQuestionIndex=0;showQuestion()}}
function awardXP(amt){userData.xp+=amt;const nl=Math.floor(userData.xp/100)+1;if(nl>userData.level){userData.level=nl;alert(`Level Up! You are now Level ${userData.level}!`)}updateStats()}
function checkBadges(){let nb=[];if(!userData.badges.includes('first_steps')&&Object.keys(userData.questionAttempts).length>0){userData.badges.push('first_steps');nb.push('First Steps')}if(!userData.badges.includes('paper1_master')&&topics.paper1.every(t=>{const p=userData.topicProgress[t.id];return p&&p.mastery>=80})){userData.badges.push('paper1_master');nb.push('Paper 1 Master')}if(!userData.badges.includes('paper2_master')&&topics.paper2.every(t=>{const p=userData.topicProgress[t.id];return p&&p.mastery>=80})){userData.badges.push('paper2_master');nb.push('Paper 2 Master')}if(!userData.badges.includes('level_5')&&userData.level>=5){userData.badges.push('level_5');nb.push('Level 5')}if(!userData.badges.includes('perfectionist')&&Object.values(userData.topicProgress).some(p=>p.mastery===100)){userData.badges.push('perfectionist');nb.push('Perfectionist')}if(!userData.badges.includes('scholar')&&calculateOverallMastery()>=80){userData.badges.push('scholar');nb.push('Scholar')}if(nb.length>0)setTimeout(()=>alert(`New Badge${nb.length>1?'s':''}: ${nb.join(', ')}!`),500);updateStats();renderBadges()}
function renderBadges(){const c=document.getElementById('badgesContainer');c.innerHTML='';badges.forEach(b=>{const e=userData.badges.includes(b.id);const d=document.createElement('div');d.className=`badge-item ${e?'earned':'locked'}`;d.innerHTML=`<div class="badge-icon">${b.icon}</div><div class="badge-name">${b.name}</div><div style="font-size:10px;color:#718096;margin-top:4px">${b.req}</div>`;c.appendChild(d)})}
function updateHomeScreen(){const p1t=topics.paper1;let p1c=0;p1t.forEach(t=>{const p=userData.topicProgress[t.id];if(p&&p.mastery>=80)p1c++});const p1p=Math.round((p1c/p1t.length)*100);document.getElementById('paper1Progress').textContent=p1p+'% Complete';const p1b=document.getElementById('paper1Badge');if(p1p===100){p1b.textContent='Mastered';p1b.className='topic-badge badge-mastered'}else if(p1p>0){p1b.textContent='In Progress';p1b.className='topic-badge badge-progress'}const p2t=topics.paper2;let p2c=0;p2t.forEach(t=>{const p=userData.topicProgress[t.id];if(p&&p.mastery>=80)p2c++});const p2p=Math.round((p2c/p2t.length)*100);document.getElementById('paper2Progress').textContent=p2p+'% Complete';const p2b=document.getElementById('paper2Badge');if(p2p===100){p2b.textContent='Mastered';p2b.className='topic-badge badge-mastered'}else if(p2p>0){p2b.textContent='In Progress';p2b.className='topic-badge badge-progress'}}
function renderProgressDetails(){const c=document.getElementById('progressDetails');let h='<h3 style="margin-top:25px;color:#2d3748">Paper 1: Reading</h3><div class="topic-list">';topics.paper1.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};h+=`<div class="topic-card ${p.mastery>=80?'completed':p.completed>0?'in-progress':''}"><div class="topic-header"><div class="topic-title">${t.title}</div><div class="topic-badge ${p.mastery>=80?'badge-mastered':p.completed>0?'badge-progress':'badge-new'}">${p.mastery>=80?'Mastered':p.completed>0?'In Progress':'Not Started'}</div></div><div class="topic-progress">${p.mastery}% (${p.completed}/${p.total})</div></div>`});h+='</div><h3 style="margin-top:25px;color:#2d3748">Paper 2: Writing</h3><div class="topic-list">';topics.paper2.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};h+=`<div class="topic-card ${p.mastery>=80?'completed':p.completed>0?'in-progress':''}"><div class="topic-header"><div class="topic-title">${t.title}</div><div class="topic-badge ${p.mastery>=80?'badge-mastered':p.completed>0?'badge-progress':'badge-new'}">${p.mastery>=80?'Mastered':p.completed>0?'In Progress':'Not Started'}</div></div><div class="topic-progress">${p.mastery}% (${p.completed}/${p.total})</div></div>`});h+='</div>';c.innerHTML=h}
function generateReport(){let r='CAMBRIDGE IGCSE FIRST LANGUAGE ENGLISH 0500\nPROGRESS REPORT\n'+'='.repeat(50)+'\n\n';r+=`Date: ${new Date().toLocaleString()}\n\nLevel: ${userData.level}\nXP: ${userData.xp}\nBadges: ${userData.badges.length}/${badges.length}\nOverall Mastery: ${calculateOverallMastery()}%\n\n`;r+='='.repeat(50)+'\nPAPER 1: READING\n'+'='.repeat(50)+'\n\n';topics.paper1.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};r+=`${t.title}\n  Mastery: ${p.mastery}%\n  Questions: ${p.completed}/${p.total}\n  Status: ${p.mastery>=80?'MASTERED':p.completed>0?'IN PROGRESS':'NOT STARTED'}\n\n`});r+='='.repeat(50)+'\nPAPER 2: WRITING\n'+'='.repeat(50)+'\n\n';topics.paper2.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};r+=`${t.title}\n  Mastery: ${p.mastery}%\n  Questions: ${p.completed}/${p.total}\n  Status: ${p.mastery>=80?'MASTERED':p.completed>0?'IN PROGRESS':'NOT STARTED'}\n\n`});r+='='.repeat(50)+'\nBADGES EARNED\n'+'='.repeat(50)+'\n\n';badges.forEach(b=>{if(userData.badges.includes(b.id))r+=`${b.icon} ${b.name} - ${b.req}\n`});r+='\n'+'='.repeat(50)+'\nEND OF REPORT\n';const bl=new Blob([r],{type:'text/plain'});const u=URL.createObjectURL(bl);const a=document.createElement('a');a.href=u;a.download=`IGCSE_Progress_${new Date().toISOString().split('T')[0]}.txt`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u)}
function exportProgress(){const d=JSON.stringify(userData,null,2);const bl=new Blob([d],{type:'application/json'});const u=URL.createObjectURL(bl);const a=document.createElement('a');a.href=u;a.download=`IGCSE_Progress_${new Date().toISOString().split('T')[0]}.json`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u)}
function importProgress(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=function(ev){try{const im=JSON.parse(ev.target.result);if(confirm('Replace current progress?')){Object.assign(userData,im);saveProgress();updateStats();renderPaper1Topics();renderPaper2Topics();renderBadges();updateHomeScreen();alert('Progress imported!')}}catch(err){alert('Error importing. Check file.')}};r.readAsText(f);e.target.value=''}
function resetProgress(){if(confirm('Reset ALL progress? Cannot be undone!')&&confirm('Really? All XP, levels, badges will be lost!')){localStorage.removeItem('igcseProgress');userData.xp=0;userData.level=1;userData.badges=[];userData.topicProgress={};userData.questionAttempts={};updateStats();renderPaper1Topics();renderPaper2Topics();renderBadges();updateHomeScreen();alert('Progress reset.')}}
window.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>