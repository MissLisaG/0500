<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IGCSE English 0500 Learning App</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;color:#333}canvas{pointer-events:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:9999}.container{max-width:1000px;margin:0 auto;background:#fff;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden;position:relative}.header{background:linear-gradient(135deg,#5a67d8 0%,#6b46c1 100%);color:#fff;padding:30px;text-align:center}.header h1{font-size:24px;margin-bottom:10px}.progress-bar-container{background:rgba(255,255,255,0.2);height:8px;border-radius:4px;margin-top:15px}.progress-bar{background:#48bb78;height:100%;border-radius:4px;transition:width 0.3s}.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px;padding:20px;background:#f7fafc;border-bottom:2px solid #e2e8f0}.stat-card{background:#fff;padding:15px;border-radius:10px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:transform 0.3s}.stat-card:hover{transform:scale(1.05)}.stat-card .label{font-size:11px;color:#718096;text-transform:uppercase}.stat-card .value{font-size:22px;font-weight:bold;color:#5a67d8}.nav-tabs{display:flex;background:#edf2f7;padding:0 20px;border-bottom:2px solid #cbd5e0;overflow-x:auto}.nav-tab{padding:12px 20px;background:none;border:none;cursor:pointer;font-size:14px;color:#4a5568;border-bottom:3px solid transparent;transition:all 0.3s}.nav-tab:hover{color:#5a67d8;background:rgba(90,103,216,0.1)}.nav-tab.active{color:#5a67d8;font-weight:bold;border-bottom-color:#5a67d8;background:#fff}.content{padding:30px}.section{display:none}.section.active{display:block;animation:fadeIn 0.3s}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.topic-list{display:grid;gap:15px}.topic-card{background:#fff;border:2px solid #e2e8f0;border-radius:12px;padding:20px;cursor:pointer;transition:all 0.3s}.topic-card:hover{border-color:#5a67d8;transform:translateY(-2px)}.topic-card.completed{border-color:#48bb78;background:linear-gradient(to right,#f0fff4 0%,#fff 20%)}.topic-card.in-progress{border-color:#ed8936;background:linear-gradient(to right,#fffaf0 0%,#fff 20%)}.topic-header{display:flex;justify-content:space-between;margin-bottom:10px}.topic-title{font-size:16px;font-weight:bold;color:#2d3748}.topic-badge{padding:4px 10px;border-radius:12px;font-size:10px;font-weight:bold;text-transform:uppercase}.badge-mastered{background:#c6f6d5;color:#22543d}.badge-progress{background:#feebc8;color:#7c2d12}.badge-new{background:#e6fffa;color:#234e52}.topic-description{color:#718096;font-size:13px;margin-bottom:10px}.topic-progress{font-size:12px;color:#4a5568;font-weight:600}.question-container{background:#f7fafc;border-radius:12px;padding:25px;margin-bottom:20px}.question-text{font-size:16px;color:#2d3748;margin-bottom:20px;line-height:1.6;white-space:pre-wrap}.question-number{display:inline-block;background:#5a67d8;color:#fff;padding:4px 12px;border-radius:6px;font-size:12px;font-weight:bold;margin-bottom:10px}.answer-input{width:100%;padding:12px;border:2px solid #cbd5e0;border-radius:8px;font-size:15px;font-family:inherit;margin-bottom:15px}textarea.answer-input{min-height:150px;resize:vertical}.answer-input:focus{outline:none;border-color:#5a67d8}.button-group{display:flex;gap:10px;flex-wrap:wrap}.btn{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.3s;text-transform:uppercase}.btn-primary{background:#5a67d8;color:#fff}.btn-primary:hover{background:#4c51bf;transform:translateY(-2px)}.btn-primary:disabled{background:#a0aec0;cursor:not-allowed;transform:none}.btn-secondary{background:#718096;color:#fff}.btn-secondary:hover{background:#4a5568}.btn-success{background:#48bb78;color:#fff}.btn-success:hover{background:#38a169}.btn-danger{background:#f56565;color:#fff}.btn-danger:hover{background:#e53e3e}.feedback{margin-top:20px;padding:20px;border-radius:12px;animation:slideIn 0.3s}@keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}.feedback.correct{background:#c6f6d5;border-left:4px solid #38a169;color:#22543d}.feedback.incorrect{background:#fed7d7;border-left:4px solid #e53e3e;color:#742a2a}.feedback-title{font-weight:bold;font-size:16px;margin-bottom:10px}.feedback-content{line-height:1.6}.assessment-grid{display:grid;gap:12px;margin-top:15px}.assessment-item{background:#fff;padding:12px;border-radius:8px;border-left:4px solid #cbd5e0;transition:all 0.3s}.assessment-item.good{border-left-color:#48bb78;animation:pulse 0.5s}.assessment-item.needs-improvement{border-left-color:#ed8936}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}.assessment-label{font-weight:bold;font-size:13px;color:#2d3748}.assessment-score{font-size:20px;font-weight:bold;color:#5a67d8;margin-right:8px}.badges-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:12px;margin-top:20px}.badge-item{background:#fff;border:2px solid #e2e8f0;border-radius:12px;padding:12px;text-align:center;transition:all 0.3s}.badge-item:hover{transform:scale(1.05)}.badge-item.earned{border-color:#48bb78;background:linear-gradient(135deg,#f0fff4 0%,#fff 100%);animation:badgeEarn 0.6s}@keyframes badgeEarn{0%{transform:scale(0.8) rotate(-10deg);opacity:0}50%{transform:scale(1.1) rotate(5deg)}100%{transform:scale(1) rotate(0)}}.badge-item.locked{opacity:0.5;filter:grayscale(100%)}.badge-icon{font-size:35px;margin-bottom:5px}.badge-name{font-size:11px;font-weight:bold;color:#2d3748}.help-section{line-height:1.8}.help-section h2{color:#5a67d8;margin:20px 0 10px;font-size:20px}.help-section h3{color:#4a5568;margin:15px 0 8px;font-size:16px}.help-section ul{margin-left:20px;margin-bottom:12px}.help-section li{margin-bottom:6px;color:#4a5568}.mastery-check{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:30px;border-radius:12px;text-align:center;margin-top:30px}.mastery-check h3{font-size:22px;margin-bottom:15px}.mastery-score{font-size:44px;font-weight:bold;margin:20px 0;animation:scaleIn 0.5s}@keyframes scaleIn{0%{transform:scale(0.5);opacity:0}100%{transform:scale(1);opacity:1}}.mastery-message{font-size:16px;margin-bottom:20px}.xp-popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#48bb78;color:#fff;padding:20px 40px;border-radius:15px;font-size:24px;font-weight:bold;z-index:10000;animation:xpBounce 0.6s;pointer-events:none}@keyframes xpBounce{0%{transform:translate(-50%,-50%) scale(0)}50%{transform:translate(-50%,-50%) scale(1.2)}100%{transform:translate(-50%,-50%) scale(1)}}.worked-example{background:#fff3cd;border-left:4px solid #ffc107;padding:15px;margin-top:15px;border-radius:8px}.worked-example-title{font-weight:bold;color:#856404;margin-bottom:10px;font-size:15px}.worked-example-content{color:#856404;line-height:1.6;font-size:14px}@media(max-width:768px){.stats{grid-template-columns:repeat(2,1fr)}.content{padding:20px}.btn{width:100%}}
</style>
</head>
<body>
<canvas id="confetti"></canvas>
<div class="container">
<div class="header">
<h1>Cambridge IGCSE First Language English 0500</h1>
<p>Master your reading and writing skills</p>
<div class="progress-bar-container"><div class="progress-bar" id="overallProgress"></div></div>
</div>
<div class="stats">
<div class="stat-card"><div class="label">Level</div><div class="value" id="levelDisplay">1</div></div>
<div class="stat-card"><div class="label">XP</div><div class="value" id="xpDisplay">0</div></div>
<div class="stat-card"><div class="label">Streak</div><div class="value" id="streakDisplay">0</div><div style="font-size:10px;color:#718096;margin-top:3px">üî• days</div></div>
<div class="stat-card"><div class="label">Badges</div><div class="value" id="badgesDisplay">0</div></div>
<div class="stat-card"><div class="label">Mastery</div><div class="value" id="masteryDisplay">0%</div></div>
</div>
<div class="nav-tabs">
<button class="nav-tab active" onclick="switchTab('home')">Home</button>
<button class="nav-tab" onclick="switchTab('paper1')">Paper 1</button>
<button class="nav-tab" onclick="switchTab('paper2')">Paper 2</button>
<button class="nav-tab" onclick="switchTab('badges')">Badges</button>
<button class="nav-tab" onclick="switchTab('progress')">Progress</button>
<button class="nav-tab" onclick="switchTab('help')">Help</button>
</div>
<div class="content">
<div id="homeSection" class="section active">
<h2 style="margin-bottom:20px;color:#2d3748">Welcome to Your Learning Journey</h2>
<p style="margin-bottom:20px;color:#4a5568;line-height:1.6">This app will help you master the skills needed for Cambridge IGCSE First Language English. Choose a paper below to begin practicing.</p>
<div class="topic-list">
<div class="topic-card" onclick="switchTab('paper1')"><div class="topic-header"><div class="topic-title">Paper 1: Reading</div><div class="topic-badge badge-new" id="paper1Badge">Start</div></div><div class="topic-description">Reading comprehension and summary writing</div><div class="topic-progress" id="paper1Progress">0% Complete</div></div>
<div class="topic-card" onclick="switchTab('paper2')"><div class="topic-header"><div class="topic-title">Paper 2: Writing</div><div class="topic-badge badge-new" id="paper2Badge">Start</div></div><div class="topic-description">Directed writing and composition</div><div class="topic-progress" id="paper2Progress">0% Complete</div></div>
</div>
</div>
<div id="paper1Section" class="section"><div id="paper1Topics"></div></div>
<div id="paper2Section" class="section"><div id="paper2Topics"></div></div>
<div id="practiceSection" class="section"><button class="btn btn-secondary" style="margin-bottom:20px" onclick="returnToTopics()">Back to Topics</button><div id="practiceContent"></div></div>
<div id="badgesSection" class="section"><h2 style="margin-bottom:20px;color:#2d3748">Your Badges</h2><div class="badges-container" id="badgesContainer"></div></div>
<div id="progressSection" class="section"><h2 style="margin-bottom:20px;color:#2d3748">Your Progress Report</h2><div style="margin-bottom:20px"><button class="btn btn-success" onclick="generateReport()">Download Report</button> <button class="btn btn-secondary" onclick="exportProgress()">Export Progress</button> <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">Import Progress</button><input type="file" id="importFile" style="display:none" accept=".json" onchange="importProgress(event)"> <button class="btn btn-danger" onclick="resetProgress()">Reset Progress</button></div><div id="progressDetails"></div></div>
<div id="helpSection" class="section"><div class="help-section"><h2>How to Use This App</h2><h3>Getting Started</h3><ul><li>Navigate using tabs at the top</li><li>Click topics to start practicing</li><li>Complete questions to earn XP and badges</li></ul><h3>Mastery System</h3><ul><li>Achieve 80% mastery in each topic to complete it</li><li>Get feedback and retry incorrect answers</li><li>Build your streak by practicing daily</li></ul><h3>Answer Assessment</h3><ul><li>Your answers are evaluated on KEY CONCEPTS, not exact phrasing</li><li>Synonyms and paraphrasing are accepted</li><li>Maintain correct spelling and grammar for full marks</li><li>After 2 failed attempts, you'll receive a worked example</li></ul><h3>Gamification</h3><ul><li>Earn XP for correct answers (20 XP short, 50 XP long)</li><li>Level up every 100 XP</li><li>Unlock badges by completing challenges</li><li>Maintain your daily streak for bonus rewards</li></ul><h3>Saving Progress</h3><ul><li>Progress saves automatically in your browser</li><li>Export/Import to backup or transfer between devices</li><li>Download reports to share with teachers</li></ul></div></div>
</div>
</div>
<script>
const userData={xp:0,level:1,badges:[],topicProgress:{},questionAttempts:{},questionFailures:{},streak:0,lastPracticeDate:null};
const badges=[
{id:'first_steps',name:'First Steps',icon:'üéØ',req:'Complete first question'},
{id:'paper1_master',name:'Paper 1 Master',icon:'üìñ',req:'Master all Paper 1 topics'},
{id:'paper2_master',name:'Paper 2 Master',icon:'‚úçÔ∏è',req:'Master all Paper 2 topics'},
{id:'level_5',name:'Level 5',icon:'‚≠ê',req:'Reach Level 5'},
{id:'level_10',name:'Level 10',icon:'üåü',req:'Reach Level 10'},
{id:'perfectionist',name:'Perfectionist',icon:'üíØ',req:'Score 100% on any topic'},
{id:'scholar',name:'Scholar',icon:'üéì',req:'Reach 80% overall mastery'},
{id:'streak_7',name:'Week Warrior',icon:'üî•',req:'7 day streak'},
{id:'streak_30',name:'Month Master',icon:'üí™',req:'30 day streak'},
{id:'speed_demon',name:'Speed Demon',icon:'‚ö°',req:'Complete 10 questions in one day'}
];
const synonymMap={
'struggling':['fighting','battling','straining','struggling','having difficulty','finding it hard'],
'heavy':['weighty','massive','hefty','heavy','ponderous','substantial'],
'weight':['mass','load','burden','weight','heaviness','pressure'],
'overloaded':['overburdened','overwhelmed','overloaded','excessive','too much'],
'strain':['stress','pressure','tension','strain','difficulty'],
'burden':['load','weight','responsibility','burden','encumbrance'],
'pressure':['force','stress','strain','pressure','compression'],
'nervous':['anxious','worried','uneasy','nervous','tense','on edge'],
'anxious':['worried','concerned','nervous','anxious','apprehensive','fearful'],
'afraid':['scared','frightened','fearful','afraid','terrified'],
'scared':['frightened','afraid','scared','terrified','alarmed'],
'worried':['concerned','anxious','troubled','worried','uneasy'],
'apprehensive':['anxious','nervous','worried','apprehensive','concerned'],
'fearful':['afraid','scared','frightened','fearful','anxious'],
'uncertain':['unsure','doubtful','hesitant','uncertain','undecided'],
'sweet':['sugary','pleasant','nice','sweet','charming'],
'flattering':['complimentary','praising','flattering','admiring'],
'insincere':['false','fake','dishonest','insincere','phony','artificial'],
'manipulative':['controlling','scheming','manipulative','deceptive'],
'persuasive':['convincing','compelling','persuasive','influential'],
'false':['untrue','fake','dishonest','false','misleading'],
'charming':['appealing','attractive','charming','pleasant'],
'deceptive':['misleading','dishonest','deceptive','false'],
'determined':['resolute','firm','determined','decided','resolved'],
'strong':['powerful','robust','sturdy','strong','solid'],
'resilient':['tough','hardy','resilient','durable','strong'],
'surviving':['enduring','lasting','surviving','persisting'],
'persistence':['perseverance','determination','persistence','tenacity'],
'fight':['struggle','battle','combat','fight','resistance'],
'courage':['bravery','valor','courage','fortitude','guts']
};
const topics={
paper1:[
{id:'comprehension',title:'Reading Comprehension (Q1a-e)',description:'Understanding explicit and implicit meanings',questions:[
{type:'short',text:'Read this passage:\n\n"The ancient library stood silent, its towering shelves groaning under centuries of accumulated knowledge. Dust motes danced in the thin shafts of light that pierced the gloom."\n\nWhat does the word "groaning" suggest about the shelves?',answer:'The shelves are struggling under heavy weight and are overloaded',keyWords:['struggling','heavy','weight','overloaded','strain','burden','pressure'],synonyms:true,hints:['Think about what groaning sounds like','Consider the weight of the books','What does personification tell us?'],explanation:'The word "groaning" is personification - it suggests the shelves are under strain from the weight of many books.',workedExample:'WORKED EXAMPLE:\n\nGood answer: "The shelves are straining under the heavy load of books"\n‚úì Includes key concept: straining/struggling\n‚úì Includes key concept: heavy/weight\n‚úì Good spelling and grammar\n\nAnother good answer: "They are burdened by the weight and might collapse"\n‚úì Includes key concept: burdened/strain\n‚úì Includes key concept: weight\n‚úì Shows understanding of the effect\n\nWeak answer: "They are making noise"\n‚úó Missing why they are groaning\n‚úó Doesn\'t mention weight or strain'},
{type:'short',text:'Read this passage:\n\n"Maria hesitated at the doorway, her fingers tightening around the envelope. She had rehearsed this moment a hundred times, yet now her voice seemed to have abandoned her."\n\nWhat does this suggest about Maria\'s feelings?',answer:'Maria is nervous, anxious, and afraid about what she must do',keyWords:['nervous','anxious','afraid','scared','worried','apprehensive','fearful','uncertain'],synonyms:true,hints:['Look at her physical actions - what do they show?','Think about why her voice would abandon her','Consider the word "hesitated"'],explanation:'The passage shows Maria\'s anxiety through implicit details: she hesitates, grips the envelope tightly, and loses her voice despite preparation.',workedExample:'WORKED EXAMPLE:\n\nGood answer: "Maria feels apprehensive and worried about the situation"\n‚úì Uses synonyms (apprehensive = nervous/anxious)\n‚úì Shows understanding of her emotional state\n‚úì Correct spelling and grammar\n\nAnother good answer: "She is scared and uncertain"\n‚úì Includes key emotions\n‚úì Simple but accurate\n\nWeak answer: "She is holding an envelope"\n‚úó Describes action, not feelings\n‚úó Doesn\'t answer the question'},
{type:'short',text:'Read this sentence:\n\n"The politician\'s words dripped with honey, each promise sweeter than the last."\n\nWhat does "dripped with honey" suggest about the politician\'s speech?',answer:'The speech was overly sweet, flattering, and possibly insincere or manipulative',keyWords:['sweet','flattering','insincere','manipulative','persuasive','false','charming','deceptive'],synonyms:true,hints:['Think about honey - what is it like?','Consider why this metaphor might be used negatively','What does "overly sweet" imply about sincerity?'],explanation:'"Dripped with honey" is a metaphor suggesting the politician\'s words were excessively sweet and flattering, implying they may be insincere.',workedExample:'WORKED EXAMPLE:\n\nGood answer: "The politician was being charming but possibly dishonest"\n‚úì Recognizes the flattering nature\n‚úì Identifies the negative implication\n‚úì Shows critical thinking\n\nAnother good answer: "The words were persuasive and manipulative"\n‚úì Understands the technique\n‚úì Recognizes the intent\n\nWeak answer: "The politician likes honey"\n‚úó Takes metaphor literally\n‚úó Misses the meaning'},
{type:'short',text:'Read this passage:\n\n"The old oak tree stood defiant against the storm, its roots clinging desperately to the eroding cliff edge."\n\nWhat impression does this create of the tree?',answer:'The tree is determined, strong, and resilient but struggling to survive',keyWords:['determined','strong','resilient','struggling','surviving','persistence','fight','courage'],synonyms:true,hints:['Consider the word "defiant" - what does it mean?','Look at what the roots are doing','Think about the tree as if it were a person'],explanation:'The personification creates an image of the tree as determined and resilient, fighting to survive despite difficult circumstances.',workedExample:'WORKED EXAMPLE:\n\nGood answer: "The tree shows courage and determination as it battles to survive"\n‚úì Recognizes personification\n‚úì Includes multiple key concepts\n‚úì Shows understanding of the struggle\n\nAnother good answer: "It is resilient but finding it hard to hold on"\n‚úì Shows the tree\'s strength\n‚úì Acknowledges the difficulty\n\nWeak answer: "The tree has roots"\n‚úó States obvious fact\n‚úó Misses the impression/feeling'}
]},
{id:'summary',title:'Summary Writing (Q1f)',description:'Selecting and organizing information concisely',questions:[
{type:'long',text:'Read this passage about sustainable farming:\n\n"Modern sustainable farming employs various techniques to protect the environment. Crop rotation prevents soil depletion by alternating different plants each season. Farmers use natural pest control methods, introducing beneficial insects rather than chemical pesticides. Water conservation systems collect rainwater for irrigation, reducing dependence on groundwater. Organic fertilizers enrich the soil without harmful chemicals. Many farms now integrate solar panels to generate clean energy for operations."\n\nWrite a summary of the sustainable farming techniques mentioned. Use your own words. (Maximum 60 words)',answer:'',wordLimit:60,assessmentCriteria:{relevance:'crop rotation, natural pest control, water conservation, organic fertilizers, solar energy',ownWords:'Uses different vocabulary',conciseness:'Within 60 words',organization:'Logical flow'},hints:['Identify all five techniques first','Rephrase each one in your own words','Keep under 60 words'],explanation:'A good summary identifies all five techniques and expresses them concisely in your own words without copying phrases.',workedExample:'WORKED EXAMPLE:\n\nGood summary (52 words):\n"Sustainable agriculture uses several eco-friendly methods. Farmers alternate crops annually to maintain soil health and employ helpful bugs instead of toxic sprays for pest management. They gather rainfall for watering plants and apply natural fertilizers to enrich earth. Additionally, renewable energy from sun panels powers farm activities."\n‚úì All 5 techniques included\n‚úì Own words used throughout\n‚úì Within word limit\n‚úì Well organized\n\nWeak summary:\n"Crop rotation prevents soil depletion. Natural pest control. Water conservation. Organic fertilizers. Solar panels."\n‚úó Copied from text\n‚úó Not in complete sentences\n‚úó Too brief, lacks development'}
]},
{id:'language_analysis',title:'Language Analysis (Q2d)',description:'Analyzing how writers use language to create effects',questions:[
{type:'long',text:'Read these two paragraphs:\n\nPARAGRAPH 1:\n"The storm unleashed its fury upon the coastline. Waves crashed against the rocks like angry fists pounding a door, sending white spray exploding into the darkening sky. The wind howled through the abandoned streets, rattling windows and tearing at anything left unsecured."\n\nPARAGRAPH 2:\n"Lightning split the heavens with savage intensity, each bolt a jagged scar across the bruised clouds. Thunder rolled and rumbled, shaking the very foundations of buildings. Rain lashed down in horizontal sheets, transforming streets into torrents and battering everything in its merciless path."\n\nSelect THREE examples from EACH paragraph (6 total) and explain how the writer creates a sense of the storm\'s power and violence. Comment on:\n‚Ä¢ The effect of specific words and phrases\n‚Ä¢ The use of literary techniques\n‚Ä¢ How the language influences the reader\n\n(Write 200-250 words)',answer:'',wordLimit:250,requireSixExamples:true,assessmentCriteria:{selection:'Identifies 3 examples from EACH paragraph',analysis:'Explains precise meanings and effects',terminology:'Uses literary terms correctly',detail:'Thorough explanation of each example'},hints:['Find 3 examples from paragraph 1 AND 3 from paragraph 2','Look for personification, similes, and powerful verbs','Explain the effect on the reader for each example'],explanation:'Strong examples from Para 1: "unleashed its fury" (personification), "like angry fists pounding" (simile), "howled/exploding/tearing" (violent verbs). Para 2: "split the heavens" (dramatic verb), "jagged scar" (metaphor), "lashed/battering/merciless" (violent language). Explain each with precise detail.',workedExample:'WORKED EXAMPLE:\n\nGood response structure:\n\nParagraph 1 Analysis:\n1. "unleashed its fury" - This personification gives the storm human anger, making it seem deliberately violent and frightening to the reader.\n\n2. "like angry fists pounding" - The simile compares waves to aggressive fists, emphasizing brutal, relentless force that creates fear.\n\n3. "howled" - This verb personifies the wind as a wild animal, suggesting uncontrolled, threatening power.\n\nParagraph 2 Analysis:\n1. "split the heavens" - Dramatic verb suggesting violent tearing, making the storm seem destructively powerful.\n\n2. "jagged scar" - Metaphor comparing lightning to a wound, implying the storm damages even the sky itself.\n\n3. "merciless path" - Personification showing the storm has no pity, creating a sense of danger and vulnerability.\n\n‚úì 3 examples from each paragraph\n‚úì Techniques identified\n‚úì Effects explained clearly'},
{type:'long',text:'Read these two paragraphs:\n\nPARAGRAPH 1:\n"The garden had fallen into neglect. Weeds strangled the once-pristine flowerbeds, their tendrils creeping across pathways like grasping fingers. The fountain, long silent, wore a coat of green moss."\n\nPARAGRAPH 2:\n"Roses drooped sadly, their petals brown and curling at the edges. The lawn had become a wilderness of tangled grass and thistles, while ivy consumed the garden walls in a slow, choking embrace. Paint peeled from the forgotten bench like dead skin."\n\nChoose THREE examples from EACH paragraph (6 total) and explain how the writer creates an impression of abandonment and decay. Comment on:\n‚Ä¢ Word choices and connotations\n‚Ä¢ Use of imagery and figurative language  \n‚Ä¢ The overall effect on the reader\n\n(Write 200-250 words)',answer:'',wordLimit:250,requireSixExamples:true,assessmentCriteria:{selection:'3 examples from EACH paragraph',analysis:'Explains connotations',terminology:'Identifies techniques',detail:'Develops effect on reader'},hints:['Select 3 from paragraph 1 AND 3 from paragraph 2','Consider verbs like "strangled," "creeping," "drooped"','Look for personification and simile in both paragraphs'],explanation:'Key examples - Para 1: "strangled" (violent verb/death), "creeping...like grasping fingers" (sinister simile), "wore a coat" (personification/neglect). Para 2: "drooped sadly" (personification/pathetic), "wilderness" (metaphor/loss of control), "like dead skin" (simile/decay).',workedExample:'WORKED EXAMPLE:\n\nParagraph 1:\n1. "strangled" - Violent verb implying the weeds are killing the flowers, creating an image of death and destruction through neglect.\n\n2. "creeping...like grasping fingers" - Sinister simile suggesting the weeds are threatening and taking over, making decay seem almost alive and intentional.\n\n3. "wore a coat" - Personification showing the moss has completely covered the fountain, emphasizing how long it has been abandoned.\n\nParagraph 2:\n1. "drooped sadly" - Personification giving the roses human emotion, creating a pathetic, melancholy mood that evokes sympathy.\n\n2. "wilderness" - Metaphor showing complete loss of human control, emphasizing how the garden has returned to a wild, uncared-for state.\n\n3. "like dead skin" - Disturbing simile comparing peeling paint to decay of living things, reinforcing themes of deterioration and death.\n\n‚úì All 6 examples covered\n‚úì Effects explained thoroughly\n‚úì Connotations explored'}
]},
{id:'extended_response',title:'Extended Response (Q3)',description:'Writing from different perspectives',questions:[
{type:'long',text:'Imagine you are a local journalist. Last night, a historic building in your town caught fire. Firefighters worked through the night to save it.\n\nWrite an article for the local newspaper describing:\n‚Ä¢ What happened during the fire\n‚Ä¢ How the community responded\n‚Ä¢ The significance of the building to local residents\n\nWrite 200-250 words.',answer:'',wordLimit:250,assessmentCriteria:{content:'Addresses all three bullet points',perspective:'Maintains journalist voice',description:'Vivid, specific details',register:'Appropriate newspaper style',structure:'Clear organization',accuracy:'Correct grammar and spelling'},hints:['Use past tense and third person','Include quotes from witnesses','Use journalistic style with clear facts'],explanation:'Your article should report objectively, include community reactions, explain historical importance, and maintain professional newspaper style.',workedExample:'WORKED EXAMPLE:\n\nGood opening: "Fire crews battled through the night to save the historic Town Hall after flames engulfed the 200-year-old building late Tuesday evening."\n‚úì Clear, factual reporting\n‚úì Key information in first sentence\n‚úì Professional tone\n\nBody should include:\n- Specific details about the fire\n- Quoted reactions from residents\n- Historical significance explained\n- Current status of building\n\nWeak opening: "There was a fire last night."\n‚úó Too vague\n‚úó Lacks important details\n‚úó Not engaging'}
]}
],
paper2:[
{id:'directed_writing',title:'Directed Writing (Section A)',description:'Writing to argue, persuade or discuss',questions:[
{type:'long',text:'Read this information:\n\nYour school is considering banning mobile phones on campus entirely. Supporters argue phones distract from learning and reduce face-to-face interaction. Critics claim phones are essential for safety, research, and communication.\n\nWrite a letter to your headteacher presenting your views. You should:\n‚Ä¢ Evaluate arguments for and against\n‚Ä¢ Present your position with reasoning\n‚Ä¢ Suggest alternative solutions\n\nWrite 250-350 words.',answer:'',wordLimit:350,assessmentCriteria:{content:'Addresses all bullet points',register:'Formal letter format',structure:'Clear organization',persuasion:'Effective techniques',vocabulary:'Sophisticated choices',accuracy:'Minimal errors'},hints:['Use proper letter format','Balance both viewpoints','Use formal language'],explanation:'Your letter should use formal conventions, evaluate both perspectives, present a clear position, and suggest alternatives.'}
]},
{id:'descriptive_writing',title:'Descriptive Writing (Section B)',description:'Creating vivid descriptions',questions:[
{type:'long',text:'Write a description suggested by this title:\n\n"The Abandoned Fairground"\n\nCreate a vivid picture using sensory details and varied language. Focus on atmosphere and mood.\n\nWrite 350-450 words.',answer:'',wordLimit:450,assessmentCriteria:{imagery:'Strong sensory images',vocabulary:'Sophisticated choices',structure:'Effective organization',techniques:'Literary devices',engagement:'Maintains interest',accuracy:'Excellent control'},hints:['Use all five senses','Vary your focus','Create eerie mood'],explanation:'Your description should paint a vivid picture using rich sensory details, varied focus, and figurative language to create atmosphere.'}
]},
{id:'narrative_writing',title:'Narrative Writing (Section B)',description:'Creating engaging stories',questions:[
{type:'long',text:'Write a story that begins:\n\n"The package arrived on a Tuesday, addressed to someone who had never lived at this house..."\n\nDevelop an engaging plot with characterization and narrative techniques.\n\nWrite 350-450 words.',answer:'',wordLimit:450,assessmentCriteria:{plot:'Well-developed storyline',character:'Convincing characters',narrative:'Effective techniques',vocabulary:'Varied choices',structure:'Controlled pacing',accuracy:'Strong control'},hints:['Decide the mystery first','Show character through actions','Create satisfying resolution'],explanation:'Your narrative should develop the opening into a complete story with believable characters, carefully paced plot, and effective conclusion.'}
]}
]
};
let currentTopic=null,currentQuestionIndex=0,hintIndex=0,questionsToday=0;
function init(){loadProgress();updateStats();renderPaper1Topics();renderPaper2Topics();renderBadges();updateHomeScreen();checkStreak()}
function loadProgress(){const s=localStorage.getItem('igcseProgress');if(s){Object.assign(userData,JSON.parse(s));const today=new Date().toDateString();if(userData.lastPracticeDate===today){questionsToday=userData.questionsToday||0}}}
function saveProgress(){const today=new Date().toDateString();userData.lastPracticeDate=today;userData.questionsToday=questionsToday;localStorage.setItem('igcseProgress',JSON.stringify(userData))}
function updateStats(){document.getElementById('levelDisplay').textContent=userData.level;document.getElementById('xpDisplay').textContent=userData.xp;document.getElementById('badgesDisplay').textContent=userData.badges.length;document.getElementById('streakDisplay').textContent=userData.streak||0;const m=calculateOverallMastery();document.getElementById('masteryDisplay').textContent=m+'%';document.getElementById('overallProgress').style.width=m+'%';saveProgress()}
function checkStreak(){const today=new Date().toDateString();const last=userData.lastPracticeDate;if(!last){userData.streak=0}else if(last===today){return}else{const lastDate=new Date(last);const todayDate=new Date(today);const diff=Math.floor((todayDate-lastDate)/(1000*60*60*24));if(diff===1){userData.streak=(userData.streak||0)+1;showXPPopup(`üî• ${userData.streak} Day Streak!`)}else if(diff>1){userData.streak=0}}saveProgress()}
function calculateOverallMastery(){let t=0,m=0;['paper1','paper2'].forEach(p=>{topics[p].forEach(tp=>{t++;const pr=userData.topicProgress[tp.id];if(pr&&pr.mastery>=80)m++})});return t>0?Math.round((m/t)*100):0}
function switchTab(tab){document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));event.target.classList.add('active');document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));const sm={'home':'homeSection','paper1':'paper1Section','paper2':'paper2Section','badges':'badgesSection','progress':'progressSection','help':'helpSection'};document.getElementById(sm[tab]).classList.add('active');if(tab==='progress')renderProgressDetails()}
function renderPaper1Topics(){const c=document.getElementById('paper1Topics');c.innerHTML='<h2 style="margin-bottom:20px;color:#2d3748">Paper 1: Reading</h2>';const tl=document.createElement('div');tl.className='topic-list';topics.paper1.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};tl.appendChild(createTopicCard(t,p))});c.appendChild(tl)}
function renderPaper2Topics(){const c=document.getElementById('paper2Topics');c.innerHTML='<h2 style="margin-bottom:20px;color:#2d3748">Paper 2: Writing</h2>';const tl=document.createElement('div');tl.className='topic-list';topics.paper2.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};tl.appendChild(createTopicCard(t,p))});c.appendChild(tl)}
function createTopicCard(t,p){const c=document.createElement('div');c.className='topic-card';if(p.mastery>=80)c.classList.add('completed');else if(p.completed>0)c.classList.add('in-progress');const b=p.mastery>=80?'badge-mastered':p.completed>0?'badge-progress':'badge-new';const bt=p.mastery>=80?'Mastered':p.completed>0?'In Progress':'New';c.innerHTML=`<div class="topic-header"><div class="topic-title">${t.title}</div><div class="topic-badge ${b}">${bt}</div></div><div class="topic-description">${t.description}</div><div class="topic-progress">${p.mastery}% Mastery (${p.completed}/${p.total} questions)</div>`;c.onclick=()=>startTopic(t);return c}
function startTopic(t){currentTopic=t;currentQuestionIndex=0;document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));document.getElementById('practiceSection').classList.add('active');showQuestion()}
function returnToTopics(){currentTopic=null;currentQuestionIndex=0;document.getElementById('practiceSection').classList.remove('active');document.getElementById('homeSection').classList.add('active');renderPaper1Topics();renderPaper2Topics();updateHomeScreen()}
function showQuestion(){if(!currentTopic)return;const q=currentTopic.questions[currentQuestionIndex];const c=document.getElementById('practiceContent');c.innerHTML=`<h2 style="margin-bottom:20px;color:#2d3748">${currentTopic.title}</h2><div class="question-container"><div class="question-number">Question ${currentQuestionIndex+1} of ${currentTopic.questions.length}</div><div class="question-text">${q.text}</div>${q.type==='short'?'<input type="text" class="answer-input" id="answerInput" placeholder="Type your answer...">':'<textarea class="answer-input" id="answerInput" placeholder="Type your answer..." rows="10"></textarea>'}${q.wordLimit?`<div style="color:#718096;font-size:13px;margin-top:5px">Word limit: ${q.wordLimit} | Current: <span id="wordCount">0</span> words</div>`:''}<div class="button-group"><button class="btn btn-primary" onclick="submitAnswer()">Submit</button> <button class="btn btn-secondary" onclick="showHint()">Hint</button></div></div><div id="feedbackContainer"></div>`;if(q.wordLimit)document.getElementById('answerInput').addEventListener('input',()=>{const t=document.getElementById('answerInput').value.trim();const w=t.length>0?t.split(/\s+/).length:0;document.getElementById('wordCount').textContent=w})}
function showHint(){const q=currentTopic.questions[currentQuestionIndex];if(!q.hints||hintIndex>=q.hints.length){alert('No more hints!');return}const fc=document.getElementById('feedbackContainer');const hd=document.createElement('div');hd.className='feedback';hd.style.background='#e6fffa';hd.style.borderLeftColor='#319795';hd.style.color='#234e52';hd.innerHTML=`<div class="feedback-title">üí° Hint ${hintIndex+1}:</div><div class="feedback-content">${q.hints[hintIndex]}</div>`;fc.appendChild(hd);hintIndex++}
function submitAnswer(){const a=document.getElementById('answerInput').value.trim();const q=currentTopic.questions[currentQuestionIndex];if(!a){alert('Please provide an answer.');return}const sb=event.target;sb.disabled=true;sb.textContent='Checking...';const f=q.type==='short'?assessShortAnswer(a,q):assessLongAnswer(a,q);const qKey=currentTopic.id+'_'+currentQuestionIndex;if(!f.correct){if(!userData.questionFailures[qKey])userData.questionFailures[qKey]=0;userData.questionFailures[qKey]++}displayFeedback(f);if(f.correct){questionsToday++;const xp=q.type==='short'?20:50;awardXP(xp);updateTopicProgress(true);launchConfetti();showXPPopup(`+${xp} XP`);userData.questionFailures[qKey]=0}else{updateTopicProgress(false)}sb.disabled=false;sb.textContent='Submit'}
function findSynonyms(word){const lower=word.toLowerCase();if(synonymMap[lower])return synonymMap[lower];return[lower]}
function assessShortAnswer(ua,q){const normalized=ua.toLowerCase().trim();const spelling=checkSpelling(ua);const grammar=checkGrammar(ua);const keyWords=q.keyWords||[];let keyWordScore=0;let foundKeys=[];let matchedConcepts=[];if(keyWords.length>0){keyWords.forEach(kw=>{const syns=q.synonyms?findSynonyms(kw):[kw.toLowerCase()];const found=syns.some(syn=>normalized.includes(syn));if(found){keyWordScore++;foundKeys.push(kw);matchedConcepts.push(kw)}});keyWordScore=(keyWordScore/keyWords.length)*100}else{const expected=q.answer.toLowerCase().trim();const expWords=expected.split(/\s+/).filter(w=>w.length>3);const matchedWords=expWords.filter(w=>normalized.includes(w));keyWordScore=(matchedWords.length/expWords.length)*100}const spellingScore=Math.max(0,100-(spelling.length*15));const grammarScore=Math.max(0,100-(grammar.length*15));const hasMinLength=ua.split(/\s+/).length>=3;let suggestions=[];let detailedFeedback='';if(keyWordScore<70){const missing=keyWords.filter(k=>!foundKeys.includes(k));suggestions.push(`You need to include these key concepts: ${missing.join(', ')}`);detailedFeedback+=`\n\nüìù WHAT'S MISSING:\nYour answer should discuss: ${missing.join(', ')}. `;if(matchedConcepts.length>0){detailedFeedback+=`You mentioned ${matchedConcepts.join(', ')} which is good, but you need ALL the key concepts. `}detailedFeedback+=`\n\nüí° TIP: Try using synonyms like:\n`;missing.forEach(m=>{const syns=findSynonyms(m);detailedFeedback+=`‚Ä¢ Instead of "${m}", you could say: ${syns.slice(0,4).join(', ')}\n`})}if(spelling.length>0){suggestions.push('Spelling errors: '+spelling.join(', '));detailedFeedback+=`\n\n‚úèÔ∏è SPELLING: Fix these errors: ${spelling.join(', ')}`}if(grammar.length>0){suggestions.push('Grammar issues: '+grammar.join('; '));detailedFeedback+=`\n\nüìñ GRAMMAR: ${grammar.join('; ')}`}if(!hasMinLength){suggestions.push('Provide a more complete answer');detailedFeedback+=`\n\nüìè LENGTH: Write at least one complete sentence with proper detail.`}const overallScore=Math.round((keyWordScore*0.6)+(spellingScore*0.2)+(grammarScore*0.2));const correct=keyWordScore>=70&&spellingScore>=70&&grammarScore>=70&&hasMinLength;return{correct,score:overallScore,keyWordScore:Math.round(keyWordScore),spellingScore:Math.round(spellingScore),grammarScore:Math.round(grammarScore),feedback:correct?'‚úì Excellent! You included the key concepts with good spelling and grammar.':'‚úó Your answer needs improvement. '+q.explanation+detailedFeedback,suggestions}}
function assessLongAnswer(ua,q){const wc=ua.split(/\s+/).length;const a={clarity:0,accuracy:0,grammar:0,spelling:0,overall:0,suggestions:[],detailedFeedback:''};if(q.wordLimit){if(wc>q.wordLimit*1.1){a.suggestions.push(`Exceeds word limit (${wc}/${q.wordLimit})`);a.detailedFeedback+=`\nüìè WORD COUNT: You wrote ${wc} words but the limit is ${q.wordLimit}. Practice being more concise.`}else if(wc<q.wordLimit*0.7){a.suggestions.push(`Too short (${wc}/${q.wordLimit})`);a.detailedFeedback+=`\nüìè WORD COUNT: You only wrote ${wc} words but need at least ${Math.round(q.wordLimit*0.7)}. Develop your ideas more fully.`}}const se=checkSpelling(ua);const gi=checkGrammar(ua);a.spelling=Math.max(0,100-(se.length*10));a.grammar=Math.max(0,100-(gi.length*10));if(se.length>0){a.suggestions.push('Spelling errors found');a.detailedFeedback+=`\n‚úèÔ∏è SPELLING ERRORS: ${se.join(', ')}`}if(gi.length>0){a.suggestions.push('Grammar issues found');a.detailedFeedback+=`\nüìñ GRAMMAR ISSUES: ${gi.join('; ')}`}const cs=assessContent(ua,q);a.accuracy=cs.score;if(cs.score<70){a.detailedFeedback+=`\n\nüìù CONTENT ISSUES:\n${cs.detailedFeedback}`}a.suggestions.push(...cs.suggestions);a.clarity=assessClarity(ua);if(a.clarity<70){a.detailedFeedback+=`\n\nüí° CLARITY: ${a.clarity<50?'Your writing is difficult to follow. Use shorter sentences and link ideas clearly.':'Try to improve sentence variety and use transition words like "however," "therefore," "moreover."'}`}a.overall=Math.round((a.clarity+a.accuracy+a.grammar+a.spelling)/4);return{correct:a.overall>=70,score:a.overall,assessment:a,feedback:(a.overall>=80?'‚úì Excellent work!':a.overall>=70?'‚úì Good effort with room for improvement.':a.overall>=60?'‚ö† Satisfactory but needs more development.':'‚úó Your answer needs significant improvement.')+a.detailedFeedback,suggestions:a.suggestions}}
function checkSpelling(t){const cm={'recieve':'receive','occured':'occurred','seperate':'separate','definately':'definitely','arguement':'argument','untill':'until','writting':'writing','begining':'beginning','beleive':'believe','thier':'their','acheive':'achieve','wierd':'weird','occassion':'occasion','embarass':'embarrass','accomodate':'accommodate','enviroment':'environment','goverment':'government','wich':'which','alot':'a lot'};const e=[];const w=t.toLowerCase().match(/\b\w+\b/g)||[];w.forEach(wd=>{if(cm[wd])e.push(`"${wd}" should be "${cm[wd]}"`)});return[...new Set(e)]}
function checkGrammar(t){const i=[];if(/\bi\s/gi.test(t)&&!/\bI\s/.test(t))i.push('The pronoun "I" must always be capitalized');if(/\s{2,}/.test(t))i.push('Use single spaces only between words');if(/[a-z]\.[A-Z]/.test(t))i.push('Add space after periods');if(t.trim().length>0&&!/[.!?]$/.test(t.trim()))i.push('Add ending punctuation (. ! or ?)');if(/\s,|\s\.|\s!|\s\?/.test(t))i.push('No space before punctuation marks');return[...new Set(i)]}
function assessContent(ua,q){const r={score:50,suggestions:[],detailedFeedback:''};if(q.assessmentCriteria&&q.assessmentCriteria.relevance){const la=ua.toLowerCase();const kp=q.assessmentCriteria.relevance.toLowerCase().split(/,|;|\band\b/).map(p=>p.trim()).filter(p=>p);const ad=kp.filter(p=>p.split(/\s+/).some(w=>w.length>3&&la.includes(w)));const missing=kp.filter(p=>!ad.includes(p));const co=(ad.length/kp.length)*100;r.score=Math.round(co);if(co<70){r.suggestions.push(`Address all required points`);r.detailedFeedback+=`You need to cover these points: ${missing.join(', ')}. `;if(ad.length>0){r.detailedFeedback+=`You mentioned ${ad.join(', ')} which is good. `}r.detailedFeedback+=`Make sure every bullet point is fully addressed with examples and explanation.`}}if(q.requireSixExamples){const para1Mentions=((ua.match(/paragraph 1|para 1|first paragraph/gi)||[]).length);const para2Mentions=((ua.match(/paragraph 2|para 2|second paragraph/gi)||[]).length);if(para1Mentions<2||para2Mentions<2){r.score=Math.min(r.score,60);r.detailedFeedback+=`\n\nYou must select 3 examples from EACH paragraph (6 total). Make it clear which paragraph each example comes from.`}}if(q.assessmentCriteria.structure&&ua.split('\n\n').length<2){r.suggestions.push('Use clear paragraphs');r.detailedFeedback+=`\n\nOrganize your writing into paragraphs for clarity.`}return r}
function assessClarity(t){let s=100;const sn=t.split(/[.!?]+/).filter(x=>x.trim().length>0);if(sn.length===0)return 0;const as=t.split(/\s+/).length/sn.length;if(as>30)s-=20;if(as<8)s-=10;const tr=/however|therefore|furthermore|moreover|consequently|additionally|nevertheless|firstly|secondly|finally/gi;if(!tr.test(t)&&t.split(/\s+/).length>100)s-=10;return Math.max(0,s)}
function displayFeedback(f){const c=document.getElementById('feedbackContainer');const q=currentTopic.questions[currentQuestionIndex];const qKey=currentTopic.id+'_'+currentQuestionIndex;const failures=userData.questionFailures[qKey]||0;const fd=document.createElement('div');fd.className=`feedback ${f.correct?'correct':'incorrect'}`;let h=`<div class="feedback-title">${f.correct?'‚úì Correct!':'‚úó Needs Improvement'}</div><div class="feedback-content">${f.feedback}</div>`;if(q.type==='short'&&f.keyWordScore!==undefined){h+='<div class="assessment-grid">';h+=`<div class="assessment-item ${f.keyWordScore>=70?'good':'needs-improvement'}"><div class="assessment-label">Key Concepts</div><span class="assessment-score">${f.keyWordScore}/100</span></div>`;h+=`<div class="assessment-item ${f.spellingScore>=70?'good':'needs-improvement'}"><div class="assessment-label">Spelling</div><span class="assessment-score">${f.spellingScore}/100</span></div>`;h+=`<div class="assessment-item ${f.grammarScore>=70?'good':'needs-improvement'}"><div class="assessment-label">Grammar</div><span class="assessment-score">${f.grammarScore}/100</span></div>`;h+='</div>'}if(f.assessment){h+='<div class="assessment-grid">';h+=`<div class="assessment-item ${f.assessment.clarity>=70?'good':'needs-improvement'}"><div class="assessment-label">Clarity</div><span class="assessment-score">${f.assessment.clarity}/100</span></div>`;h+=`<div class="assessment-item ${f.assessment.accuracy>=70?'good':'needs-improvement'}"><div class="assessment-label">Accuracy</div><span class="assessment-score">${f.assessment.accuracy}/100</span></div>`;h+=`<div class="assessment-item ${f.assessment.grammar>=70?'good':'needs-improvement'}"><div class="assessment-label">Grammar</div><span class="assessment-score">${f.assessment.grammar}/100</span></div>`;h+=`<div class="assessment-item ${f.assessment.spelling>=70?'good':'needs-improvement'}"><div class="assessment-label">Spelling</div><span class="assessment-score">${f.assessment.spelling}/100</span></div>`;h+='</div>'}if(f.suggestions&&f.suggestions.length>0){h+='<div style="margin-top:15px"><strong>üí° Suggestions for improvement:</strong><ul style="margin-left:20px;margin-top:8px">';f.suggestions.forEach(s=>h+=`<li style="margin-bottom:5px">${s}</li>`);h+='</ul></div>'}if(!f.correct&&failures>=2&&q.workedExample){h+=`<div class="worked-example"><div class="worked-example-title">üìö WORKED EXAMPLE (You've tried ${failures} times)</div><div class="worked-example-content">${q.workedExample.replace(/\n/g,'<br>')}</div></div>`}h+=`<div style="margin-top:15px"><strong>üìñ Explanation:</strong><br>${q.explanation}</div>`;h+='<div class="button-group" style="margin-top:20px">';if(f.correct){if(currentQuestionIndex<currentTopic.questions.length-1)h+='<button class="btn btn-success" onclick="nextQuestion()">Next Question ‚Üí</button>';else h+='<button class="btn btn-success" onclick="completeTopic()">Complete Topic ‚úì</button>'}else{h+=`<button class="btn btn-primary" onclick="retryQuestion()">Try Again${failures>=1?' (Attempt '+(failures+1)+')':''}</button>`;if(currentQuestionIndex<currentTopic.questions.length-1)h+='<button class="btn btn-secondary" onclick="nextQuestion()">Skip to Next ‚Üí</button>'}h+='</div>';fd.innerHTML=h;c.innerHTML='';c.appendChild(fd);hintIndex=0}
function nextQuestion(){currentQuestionIndex++;showQuestion();hintIndex=0}
function retryQuestion(){document.getElementById('answerInput').value='';document.getElementById('feedbackContainer').innerHTML='';hintIndex=0}
function updateTopicProgress(c){if(!userData.topicProgress[currentTopic.id])userData.topicProgress[currentTopic.id]={completed:0,total:currentTopic.questions.length,correct:0,mastery:0};const p=userData.topicProgress[currentTopic.id];if(c){if(!userData.questionAttempts[currentTopic.id])userData.questionAttempts[currentTopic.id]={};if(!userData.questionAttempts[currentTopic.id][currentQuestionIndex]){p.completed++;p.correct++}userData.questionAttempts[currentTopic.id][currentQuestionIndex]=true}p.mastery=Math.round((p.correct/p.total)*100);checkBadges();saveProgress()}
function completeTopic(){const p=userData.topicProgress[currentTopic.id];if(p.mastery>=80){document.getElementById('practiceContent').innerHTML=`<div class="mastery-check"><h3>üéâ Topic Completed!</h3><div class="mastery-score">${p.mastery}%</div><div class="mastery-message">Congratulations! You have mastered this topic!</div><button class="btn btn-success" onclick="returnToTopics()" style="background:#fff;color:#5a67d8">Return to Topics</button></div>`;launchConfetti();checkBadges()}else{alert(`Your mastery is ${p.mastery}%. Need 80% to complete. Keep practicing!`);currentQuestionIndex=0;showQuestion()}}
function awardXP(amt){userData.xp+=amt;const nl=Math.floor(userData.xp/100)+1;if(nl>userData.level){userData.level=nl;showXPPopup(`üåü Level ${userData.level}!`);launchConfetti()}updateStats()}
function checkBadges(){let nb=[];if(!userData.badges.includes('first_steps')&&Object.keys(userData.questionAttempts).length>0){userData.badges.push('first_steps');nb.push('First Steps')}if(!userData.badges.includes('paper1_master')&&topics.paper1.every(t=>{const p=userData.topicProgress[t.id];return p&&p.mastery>=80})){userData.badges.push('paper1_master');nb.push('Paper 1 Master')}if(!userData.badges.includes('paper2_master')&&topics.paper2.every(t=>{const p=userData.topicProgress[t.id];return p&&p.mastery>=80})){userData.badges.push('paper2_master');nb.push('Paper 2 Master')}if(!userData.badges.includes('level_5')&&userData.level>=5){userData.badges.push('level_5');nb.push('Level 5')}if(!userData.badges.includes('level_10')&&userData.level>=10){userData.badges.push('level_10');nb.push('Level 10')}if(!userData.badges.includes('perfectionist')&&Object.values(userData.topicProgress).some(p=>p.mastery===100)){userData.badges.push('perfectionist');nb.push('Perfectionist')}if(!userData.badges.includes('scholar')&&calculateOverallMastery()>=80){userData.badges.push('scholar');nb.push('Scholar')}if(!userData.badges.includes('streak_7')&&userData.streak>=7){userData.badges.push('streak_7');nb.push('Week Warrior')}if(!userData.badges.includes('streak_30')&&userData.streak>=30){userData.badges.push('streak_30');nb.push('Month Master')}if(!userData.badges.includes('speed_demon')&&questionsToday>=10){userData.badges.push('speed_demon');nb.push('Speed Demon')}if(nb.length>0){setTimeout(()=>{alert(`üéâ New Badge${nb.length>1?'s':''} Earned: ${nb.join(', ')}!`);launchConfetti()},500)}updateStats();renderBadges()}
function renderBadges(){const c=document.getElementById('badgesContainer');c.innerHTML='';badges.forEach(b=>{const e=userData.badges.includes(b.id);const d=document.createElement('div');d.className=`badge-item ${e?'earned':'locked'}`;d.innerHTML=`<div class="badge-icon">${b.icon}</div><div class="badge-name">${b.name}</div><div style="font-size:10px;color:#718096;margin-top:4px">${b.req}</div>`;c.appendChild(d)})}
function updateHomeScreen(){const p1t=topics.paper1;let p1c=0;p1t.forEach(t=>{const p=userData.topicProgress[t.id];if(p&&p.mastery>=80)p1c++});const p1p=Math.round((p1c/p1t.length)*100);document.getElementById('paper1Progress').textContent=p1p+'% Complete';const p1b=document.getElementById('paper1Badge');if(p1p===100){p1b.textContent='Mastered';p1b.className='topic-badge badge-mastered'}else if(p1p>0){p1b.textContent='In Progress';p1b.className='topic-badge badge-progress'}const p2t=topics.paper2;let p2c=0;p2t.forEach(t=>{const p=userData.topicProgress[t.id];if(p&&p.mastery>=80)p2c++});const p2p=Math.round((p2c/p2t.length)*100);document.getElementById('paper2Progress').textContent=p2p+'% Complete';const p2b=document.getElementById('paper2Badge');if(p2p===100){p2b.textContent='Mastered';p2b.className='topic-badge badge-mastered'}else if(p2p>0){p2b.textContent='In Progress';p2b.className='topic-badge badge-progress'}}
function renderProgressDetails(){const c=document.getElementById('progressDetails');let h='<h3 style="margin-top:25px;color:#2d3748">Paper 1: Reading</h3><div class="topic-list">';topics.paper1.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};h+=`<div class="topic-card ${p.mastery>=80?'completed':p.completed>0?'in-progress':''}"><div class="topic-header"><div class="topic-title">${t.title}</div><div class="topic-badge ${p.mastery>=80?'badge-mastered':p.completed>0?'badge-progress':'badge-new'}">${p.mastery>=80?'Mastered':p.completed>0?'In Progress':'Not Started'}</div></div><div class="topic-progress">${p.mastery}% (${p.completed}/${p.total})</div></div>`});h+='</div><h3 style="margin-top:25px;color:#2d3748">Paper 2: Writing</h3><div class="topic-list">';topics.paper2.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};h+=`<div class="topic-card ${p.mastery>=80?'completed':p.completed>0?'in-progress':''}"><div class="topic-header"><div class="topic-title">${t.title}</div><div class="topic-badge ${p.mastery>=80?'badge-mastered':p.completed>0?'badge-progress':'badge-new'}">${p.mastery>=80?'Mastered':p.completed>0?'In Progress':'Not Started'}</div></div><div class="topic-progress">${p.mastery}% (${p.completed}/${p.total})</div></div>`});h+='</div>';c.innerHTML=h}
function generateReport(){let r='CAMBRIDGE IGCSE FIRST LANGUAGE ENGLISH 0500\nPROGRESS REPORT\n'+'='.repeat(50)+'\n\n';r+=`Date: ${new Date().toLocaleString()}\n\nLevel: ${userData.level}\nXP: ${userData.xp}\nStreak: ${userData.streak} days\nBadges: ${userData.badges.length}/${badges.length}\nOverall Mastery: ${calculateOverallMastery()}%\n\n`;r+='='.repeat(50)+'\nPAPER 1: READING\n'+'='.repeat(50)+'\n\n';topics.paper1.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};r+=`${t.title}\n  Mastery: ${p.mastery}%\n  Questions: ${p.completed}/${p.total}\n  Status: ${p.mastery>=80?'MASTERED':p.completed>0?'IN PROGRESS':'NOT STARTED'}\n\n`});r+='='.repeat(50)+'\nPAPER 2: WRITING\n'+'='.repeat(50)+'\n\n';topics.paper2.forEach(t=>{const p=userData.topicProgress[t.id]||{completed:0,total:t.questions.length,mastery:0};r+=`${t.title}\n  Mastery: ${p.mastery}%\n  Questions: ${p.completed}/${p.total}\n  Status: ${p.mastery>=80?'MASTERED':p.completed>0?'IN PROGRESS':'NOT STARTED'}\n\n`});r+='='.repeat(50)+'\nBADGES EARNED\n'+'='.repeat(50)+'\n\n';badges.forEach(b=>{if(userData.badges.includes(b.id))r+=`${b.icon} ${b.name} - ${b.req}\n`});r+='\n'+'='.repeat(50)+'\nEND OF REPORT\n';const bl=new Blob([r],{type:'text/plain'});const u=URL.createObjectURL(bl);const a=document.createElement('a');a.href=u;a.download=`IGCSE_Progress_${new Date().toISOString().split('T')[0]}.txt`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u)}
function exportProgress(){const d=JSON.stringify(userData,null,2);const bl=new Blob([d],{type:'application/json'});const u=URL.createObjectURL(bl);const a=document.createElement('a');a.href=u;a.download=`IGCSE_Progress_${new Date().toISOString().split('T')[0]}.json`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u)}
function importProgress(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=function(ev){try{const im=JSON.parse(ev.target.result);if(confirm('Replace current progress?')){Object.assign(userData,im);saveProgress();updateStats();renderPaper1Topics();renderPaper2Topics();renderBadges();updateHomeScreen();alert('Progress imported!')}}catch(err){alert('Error importing. Check file.')}};r.readAsText(f);e.target.value=''}
function resetProgress(){if(confirm('Reset ALL progress? Cannot be undone!')&&confirm('Really? All XP, levels, badges will be lost!')){localStorage.removeItem('igcseProgress');userData.xp=0;userData.level=1;userData.badges=[];userData.topicProgress={};userData.questionAttempts={};userData.questionFailures={};userData.streak=0;userData.lastPracticeDate=null;questionsToday=0;updateStats();renderPaper1Topics();renderPaper2Topics();renderBadges();updateHomeScreen();alert('Progress reset.')}}
function launchConfetti(){const c=document.getElementById('confetti');const ctx=c.getContext('2d');c.width=window.innerWidth;c.height=window.innerHeight;const pieces=[];const colors=['#ff6b6b','#4ecdc4','#45b7d1','#f9ca24','#6c5ce7','#a29bfe'];for(let i=0;i<100;i++){pieces.push({x:Math.random()*c.width,y:Math.random()*c.height-c.height,w:Math.random()*10+5,h:Math.random()*10+5,d:Math.random()*10+5,c:colors[Math.floor(Math.random()*colors.length)],tilt:Math.random()*10-10,tiltAngle:0,tiltAngleIncremental:(Math.random()*0.07)+.05})}let animId;function draw(){ctx.clearRect(0,0,c.width,c.height);pieces.forEach((p,i)=>{ctx.beginPath();ctx.lineWidth=p.d/2;ctx.strokeStyle=p.c;ctx.moveTo(p.x+p.tilt+(p.w/4),p.y);ctx.lineTo(p.x+p.tilt,p.y+p.tilt+(p.h/4));ctx.stroke();p.tiltAngle+=p.tiltAngleIncremental;p.y+=Math.cos(p.d)+1+p.d/2;p.x+=Math.sin(p.d);p.tilt=Math.sin(p.tiltAngle-(i/3))*15;if(p.y>c.height)pieces.splice(i,1)});if(pieces.length>0)animId=requestAnimationFrame(draw);else cancelAnimationFrame(animId)}draw();setTimeout(()=>{cancelAnimationFrame(animId);ctx.clearRect(0,0,c.width,c.height)},3000)}
function showXPPopup(txt){const p=document.createElement('div');p.className='xp-popup';p.textContent=txt;document.body.appendChild(p);setTimeout(()=>document.body.removeChild(p),1500)}
window.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>